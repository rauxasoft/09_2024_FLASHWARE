DROP TABLE IF EXISTS LINEAS_PEDIDO;
DROP TABLE IF EXISTS PEDIDOS ;
DROP TABLE IF EXISTS ESTABLECIMIENTOS;
DROP TABLE IF EXISTS PRODUCTOS;
DROP TABLE IF EXISTS PERSONAS;

CREATE TABLE PERSONAS(

	ID					BIGINT				NOT NULL,
	DNI					VARCHAR(20)			,
	NOMBRE				VARCHAR(150)		,
	APELLIDOS			VARCHAR(150)		,
	DIRECCION			VARCHAR(200)		,
	POBLACION			VARCHAR(200)		,
	CODIGO_POSTAL		VARCHAR(20)			,
	PROVINCIA			VARCHAR(200)		,
	PAIS				VARCHAR(150)		,
	TELEFONO_MOVIL		VARCHAR(25)			,
	TELEFONO_FIJO		VARCHAR(25)			,
	EMAIL				VARCHAR(250)		,
	DISCRIMINADOR		VARCHAR(10)			,
	
	PRIMARY KEY (ID)

);

CREATE TABLE PRODUCTOS(

	CODIGO				BIGINT				NOT NULL,
	NOMBRE				VARCHAR(200)		,
	DESCRIPCION			VARCHAR(250)		,
	FECHA_ALTA			DATE				,
	PRECIO				DOUBLE				,
	DESCATALOGADO		BOOLEAN				,
	CATEGORIA			VARCHAR(10)			,
	
	PRIMARY KEY (CODIGO)

);

CREATE TABLE ESTABLECIMIENTOS(

	ID					BIGINT				NOT NULL,
	NOMBRE				VARCHAR(150)		,
	DIRECCION			VARCHAR(200)		,
	POBLACION			VARCHAR(200)		,
	C_POSTAL			VARCHAR(20)			,
	PROVINCIA			VARCHAR(200)		,
	PAIS				VARCHAR(150)		,
	TELEFONO_MOVIL		VARCHAR(25)			,
	TELEFONO_FIJO		VARCHAR(25)			,
	EMAIL				VARCHAR(250)		,
	
	PRIMARY KEY (ID)

);

CREATE TABLE PEDIDOS(

	NUMERO				BIGINT				NOT NULL,
	FECHA_HORA			TIMESTAMP			,
	ESTADO				VARCHAR(30)			,
	ID_CLIENTE			BIGINT				,
	ID_TECNICO			BIGINT				,
	ID_ESTABLECIMIENTO	BIGINT				,
	OBSERVACIONES		VARCHAR(250)		,
	
	PRIMARY KEY (NUMERO),
	FOREIGN KEY (ID_CLIENTE) REFERENCES PERSONAS (ID),
	FOREIGN KEY (ID_TECNICO) REFERENCES PERSONAS (ID),
	FOREIGN KEY (ID_ESTABLECIMIENTO) REFERENCES ESTABLECIMIENTOS (ID)

);

CREATE TABLE LINEAS_PEDIDO(

	NUMERO_PEDIDO		BIGINT				NOT NULL,
	CODIGO_PRODUCTO		BIGINT				,
	CANTIDAD			INTEGER				,
	PRECIO				DOUBLE				,
	
	FOREIGN KEY (NUMERO_PEDIDO) REFERENCES PEDIDOS (NUMERO),
	FOREIGN KEY (CODIGO_PRODUCTO) REFERENCES PRODUCTOS (CODIGO)

);